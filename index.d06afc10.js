const t=new class{constructor(t){this.score=0,this.status="idle",this.initialState=t?t.map(t=>[...t]):Array.from({length:4},()=>[,,,,].fill(0)),this.board=this.initialState.map(t=>[...t])}moveLeft(){let t=this.getState();this.board.forEach((t,e)=>{let s=t.filter(t=>0!==t);for(let t=0;t<s.length-1;t++)s[t]===s[t+1]&&(s[t]=2*s[t],this.score+=s[t],s[t+1]=0,t++);for(this.board[e]=s.filter(t=>0!==t);this.board[e].length<4;)this.board[e].push(0)}),this.chechGameOver(),this.boardsAreEqual(t,this.board)||this.addRandomTile()}moveRight(){let t=this.getState();this.board.forEach((t,e)=>{let s=t.filter(t=>0!==t);for(let t=s.length-1;t>0;t--)s[t]===s[t-1]&&(s[t]=2*s[t],this.score+=s[t],s[t-1]=0,t--);for(this.board[e]=s.filter(t=>0!==t);this.board[e].length<4;)this.board[e].unshift(0)}),this.chechGameOver(),this.boardsAreEqual(t,this.board)||this.addRandomTile()}moveUp(){let t=this.getState();for(let t=0;t<4;t++){let e=[];for(let s=0;s<4;s++)e.push(this.board[s][t]);let s=e.filter(t=>0!==t);for(let t=0;t<s.length-1;t++)s[t]===s[t+1]&&(s[t]=2*s[t],this.score+=s[t],s[t+1]=0,t++);for(s=s.filter(t=>0!==t);s.length<4;)s.push(0);for(let e=0;e<4;e++)this.board[e][t]=s[e]}this.chechGameOver(),this.boardsAreEqual(t,this.board)||this.addRandomTile()}moveDown(){let t=this.getState();for(let t=0;t<4;t++){let e=[];for(let s=0;s<4;s++)e.push(this.board[s][t]);let s=e.filter(t=>0!==t);for(let t=s.length-1;t>0;t--)s[t]===s[t-1]&&(s[t]=2*s[t],this.score+=s[t],s[t-1]=0,t--);for(s=s.filter(t=>0!==t);s.length<4;)s.unshift(0);for(let e=0;e<4;e++)this.board[e][t]=s[e]}this.chechGameOver(),this.boardsAreEqual(t,this.board)||this.addRandomTile()}getScore(){return this.score}getState(){return this.board.map(t=>[...t])}getStatus(){return this.status}start(){this.score=0,this.board=Array.from({length:4},()=>[,,,,].fill(0)),this.status="playing",this.addRandomTile()}restart(){this.board=this.initialState.map(t=>[...t]),this.score=0,this.status="idle"}boardsAreEqual(t,e){for(let s=0;s<4;s++)for(let a=0;a<4;a++)if(t[s][a]!==e[s][a])return!1;return!0}addRandomTile(){let t=this.getRandomTile(),e=Math.floor(Math.random()*t.length),s=.9>Math.random()?2:4;this.board[t[e].i][t[e].j]=s}getRandomTile(){let t=[];for(let e=0;e<4;e++)for(let s=0;s<4;s++)0===this.board[e][s]&&t.push({i:e,j:s});return t}chechGameOver(){for(let t=0;t<4;t++)for(let e=0;e<4;e++){if(2048===this.board[t][e]){this.status="win";return}if(0===this.board[t][e]||t<3&&this.board[t][e]===this.board[t+1][e]||e<3&&this.board[t][e]===this.board[t][e+1])return}this.status="lose"}},e=document.querySelector(".game-score"),s=document.querySelector(".button"),a=document.querySelector(".message-lose"),r=document.querySelector(".message-win"),i=document.querySelector(".message-start"),o=document.querySelector(".tiles-container");let l={};function n(t){switch(t){case"lose":a.classList.remove("hidden");break;case"win":r.classList.remove("hidden")}}function h(t){e.textContent=t}function d(e){let s={};e.forEach((t,e)=>{t.forEach((t,a)=>{let r=`${a}-${e}`;if(0===t){l[r]&&o.removeChild(l[r]);return}if(l[r])l[r].style.transition="transform 1.15s ease-in-out",l[r].textContent=t,l[r].className=`tile tile--${t}`,l[r].style.transform=`translate(${90*a}px, ${90*e}px) scale(1)`,s[r]=l[r];else{let i=document.createElement("div");i.classList.add("tile",`tile--${t}`),i.textContent=t,i.style.transform=`translate(${90*a}px, ${90*e}px) scale(0.5)`,o.appendChild(i),requestAnimationFrame(()=>{i.style.transition="transform 0.25s ease-in-out",i.style.transform=`translate(${90*a}px, ${90*e}px) scale(1)`}),s[r]=i}})}),h(t.getScore()),l=s}s.addEventListener("click",e=>{t&&"playing"===t.getStatus()?(t.restart(),s.textContent="Start",s.className="button start"):(t.start(),s.textContent="Restart",s.className="button restart"),d(t.getState()),h(t.getScore()),i.classList.add("hidden"),r.classList.add("hidden"),a.classList.add("hidden")}),document.addEventListener("keydown",e=>{if("playing"===t.getStatus()){switch(e.key){case"ArrowUp":t.moveUp();break;case"ArrowDown":t.moveDown();break;case"ArrowLeft":t.moveLeft();break;case"ArrowRight":t.moveRight()}d(t.getState()),a.classList.add("hidden"),r.classList.add("hidden"),n(t.getStatus())}});const c=document.getElementById("switch");c.addEventListener("change",()=>{document.body.classList.toggle("dark",c.checked),document.querySelectorAll("p").forEach(t=>{t.style.color=c.checked?"#fff":"#333"}),document.querySelector(".dark-check--p").textContent=c.checked?"DARK":"LIGHT"});let u=0,m=0;const f=document.querySelector(".game-container");f.addEventListener("touchstart",t=>{t.preventDefault();let e=t.touches[0];u=e.clientX,m=e.clientY},{passive:!1}),f.addEventListener("touchend",e=>{if("playing"!==t.getStatus())return;let s=e.changedTouches[0],i=s.clientX-u,o=s.clientY-m;Math.abs(i)>Math.abs(o)?i>0?t.moveRight():t.moveLeft():Math.abs(o)>0&&(o>0?t.moveDown():t.moveUp()),d(t.getState()),a.classList.add("hidden"),r.classList.add("hidden"),n(t.getStatus())},{passive:!1});
//# sourceMappingURL=index.d06afc10.js.map
